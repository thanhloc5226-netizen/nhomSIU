{% extends 'base.html' %}
{% block body_block %}
{% load static %}
<link href="{% static 'css/khachhang.css' %}" rel="stylesheet">
   <script src="{% static 'js/khachhang.js' %}" defer></script>
<form method="get">
    <div class="search-section">
        <h3>üîç T√¨m Ki·∫øm Kh√°ch H√†ng</h3>

        <div class="row g-2 mt-2">
            <div class="col-12 col-md-6 col-lg-8">
                <input type="text"
                       name="q"
                       value="{{ request.GET.q }}"
                       class="form-control"
                       placeholder="Nh·∫≠p m√£ KH, t√™n, email, SƒêT...">
            </div>

            <div class="col-6 col-md-3 col-lg-2">
                <button type="submit" class="btn btn-primary w-100">üîç T√¨m ki·∫øm</button>
            </div>

            <div class="col-6 col-md-3 col-lg-2">
                <a href="{% url 'home' %}" class="btn btn-secondary w-100">‚úñ X√≥a</a>
            </div>
        </div>
    </div>
</form>

<!-- ===== N√öT ·∫®N / HI·ªÜN C·ªòT - REDESIGNED ===== -->
<div class="column-control-wrapper mb-3">
    <button class="btn btn-column-toggle"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#columnToggle">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
        </svg>
        <span>T√πy ch·ªânh hi·ªÉn th·ªã c·ªôt</span>
    </button>

    <div id="columnToggle" class="collapse">
        <div class="column-toggle-grid">

            <div class="column-toggle-item">
                <input type="checkbox" id="toggle-code" checked onchange="toggleColumn('col-code')">
                <label for="toggle-code">
                    <span class="checkbox-custom"></span>
                    <span class="label-text">M√£ KH</span>
                </label>
            </div>

            <div class="column-toggle-item">
                <input type="checkbox" id="toggle-name" checked onchange="toggleColumn('col-name')">
                <label for="toggle-name">
                    <span class="checkbox-custom"></span>
                    <span class="label-text">T√™n</span>
                </label>
            </div>

            <div class="column-toggle-item">
                <input type="checkbox" id="toggle-email" checked onchange="toggleColumn('col-email')">
                <label for="toggle-email">
                    <span class="checkbox-custom"></span>
                    <span class="label-text">Email</span>
                </label>
            </div>

            <div class="column-toggle-item">
                <input type="checkbox" id="toggle-phone" checked onchange="toggleColumn('col-phone')">
                <label for="toggle-phone">
                    <span class="checkbox-custom"></span>
                    <span class="label-text">SƒêT</span>
                </label>
            </div>

            <div class="column-toggle-item">
                <input type="checkbox" id="toggle-address" checked onchange="toggleColumn('col-address')">
                <label for="toggle-address">
                    <span class="checkbox-custom"></span>
                    <span class="label-text">ƒê·ªãa ch·ªâ</span>
                </label>
            </div>

            <div class="column-toggle-item">
                <input type="checkbox" id="toggle-status" checked onchange="toggleColumn('col-status')">
                <label for="toggle-status">
                    <span class="checkbox-custom"></span>
                    <span class="label-text">Tr·∫°ng th√°i</span>
                </label>
            </div>

            <div class="column-toggle-item">
                <input type="checkbox" id="toggle-note" checked onchange="toggleColumn('col-note')">
                <label for="toggle-note">
                    <span class="checkbox-custom"></span>
                    <span class="label-text">Ghi ch√∫</span>
                </label>
            </div>

            <div class="column-toggle-item">
                <input type="checkbox" id="toggle-created" checked onchange="toggleColumn('col-created')">
                <label for="toggle-created">
                    <span class="checkbox-custom"></span>
                    <span class="label-text">Ng√†y t·∫°o</span>
                </label>
            </div>

        </div>
    </div>
</div>



<!-- ===== TABLE ===== -->
<div class="table-container">
<table id="contractTable" class="table table-bordered table-hover">
<thead>
<tr>
    <th>STT</th>
    <th class="col-code">M√£ KH</th>
    <th class="col-name">T√™n</th>
    <th class="col-email">Email</th>
    <th class="col-phone">SƒêT</th>
    <th class="col-address">ƒê·ªãa ch·ªâ</th>
    <th class="col-status">Tr·∫°ng th√°i</th>
    <th class="col-note">Ghi ch√∫</th>
    <th class="col-created">Ng√†y t·∫°o</th>
    <th>H√†nh ƒë·ªông</th>
</tr>
</thead>

<tbody>
{% for c in customers %}
<tr>
    <td>{{ forloop.counter }}</td>
    <td class="col-code">{{ c.customer_code }}</td>
    <td class="col-name">{{ c.name }}</td>
    <td class="col-email">{{ c.email }}</td>
    <td class="col-phone">{{ c.phone }}</td>
    <td class="col-address">{{ c.address }}</td>

    <!-- ===== STATUS (ƒê√É S·ª¨A - HI·ªÇN TH·ªä ƒê·∫¶Y ƒê·ª¶) ===== -->
    <td class="col-status">
    {% if c.status == 'approved' %}
        <span class="badge bg-success">
            {{ c.get_status_display }}
        </span>

    {% elif c.status == 'pending' %}
        <span class="badge bg-warning text-dark">
            {{ c.get_status_display }}
        </span>

    {% elif c.status == 'completed' %}
        <span class="badge bg-primary">
            {{ c.get_status_display }}
        </span>

    {% else %}
        <span class="badge bg-secondary">
            {{ c.get_status_display }}
        </span>
    {% endif %}
</td>


    <!-- ===== NOTE ===== -->
    <td class="col-note">
        {{ c.note|default:"‚Äî"|truncatechars:30 }}
    </td>

    <td class="col-created">{{ c.created_at|date:"d/m/Y H:i" }}</td>
    <td>
        <a href="{% url 'customer_detail' c.id %}" class="btn btn-sm btn-info">Xem</a>
    </td>
</tr>
{% empty %}
<tr>
    <td colspan="10" class="text-center">Ch∆∞a c√≥ kh√°ch h√†ng n√†o</td>
</tr>
{% endfor %}
</tbody>
</table>
</div>
<h2 class="text-center fw-bold text-danger" data-aos="fade-right">
    MASCOT
</h2>

<section class="mascot_body" style="margin-top:-10%">

<div class="carousel_mascot" data-aos="fade-right">

    {% for mascot in mascots %}
    <div class="card_mascot" data-title="{{ mascot.title }}">
        <div class="speech_mascot">{{ mascot.speech }}</div>
        <img src="{{ mascot.image.url }}" alt="{{ mascot.title }}">
    </div>
    {% endfor %}

</div>
</section>



{% endblock %}